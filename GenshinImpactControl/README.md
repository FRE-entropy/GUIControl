# 原神弹琴器

一个用于在原神游戏中自动弹奏音乐的工具，可以播放MIDI文件或自定义乐谱，让你在游戏中轻松演奏美妙的音乐。

## 功能特点

- **MIDI文件播放**：支持导入并播放标准MIDI文件
- **键盘映射**：将音符映射到键盘按键，模拟游戏中的弹琴操作
- **可调节速度**：可以调整音乐播放速度
- **热键控制**：支持使用热键（Ctrl+C）中断播放

## 安装说明

### 前置条件

- Python 3.7+
- 安装必要的依赖包

### 安装步骤

1. 克隆或下载本项目

2. 安装项目依赖：
   ```bash
   cd GUIControl
   pip install -r requirements.txt
   ```
   或使用uv包管理器：
   ```bash
   uv pip install -e .
   ```

3. 确保已安装项目所需的依赖包：
   - mido（用于处理MIDI文件）
   - pynput（用于键盘和鼠标控制）
   - pyautogui（用于GUI自动化）
   - loguru（用于日志管理）

## 使用方法

### 播放MIDI文件

1. 将MIDI文件放在项目的`data/music/`目录下

2. 修改`main.py`中的文件路径指向你的MIDI文件：
   ```python
   music_player.play_midi("./data/music/你的文件.mid")
   ```

3. 运行程序：
   ```bash
   cd GenshinImpactControl
   python main.py
   ```

4. 程序将自动开始播放MIDI文件中的音乐，通过模拟按键操作在游戏中弹奏。

## 键盘映射说明

本程序使用以下键盘映射将音符转换为键盘按键：

### 音符到键盘的映射

| 音符 | 按键 | 音符 | 按键 | 音符 | 按键 |
|------|------|------|------|------|------|
| C (小字组) | Z | D (小字组) | X | E (小字组) | C |
| F (小字组) | V | G (小字组) | B | A (小字组) | N |
| B (小字组) | M | C (小字一组) | A | D (小字一组) | S |
| E (小字一组) | D | F (小字一组) | F | G (小字一组) | G |
| A (小字一组) | H | B (小字一组) | J | C (小字二组) | Q |
| D (小字二组) | W | E (小字二组) | E | F (小字二组) | R |
| G (小字二组) | T | A (小字二组) | Y | B (小字二组) | U |

## 项目结构

```
GenshinImpactControl/
├── main.py        # 主程序文件
├── README.md      # 项目说明文档
└── data/
    └── music/     # MIDI文件存放目录
```

## 注意事项

1. 使用前请确保游戏窗口处于激活状态
2. 播放过程中可以按Ctrl+C热键中断播放
3. 请遵守游戏规则，合理使用本工具
4. 某些MIDI文件可能包含不支持的音符范围，请确保使用适当音域的MIDI文件

## 依赖项

- **mido**: 用于处理MIDI文件
- **pynput**: 用于控制键盘和鼠标
- **pyautogui**: 用于GUI自动化操作
- **loguru**: 用于日志管理

## 许可证

本项目仅供学习和研究使用，请勿用于任何商业用途。使用本程序时请遵守相关游戏的用户协议。

## 故障排除

1. **程序无法找到MIDI文件**：请检查文件路径是否正确，确保MIDI文件存在于指定位置
2. **某些音符不发声**：可能是因为这些音符超出了程序支持的音域范围
3. **游戏中按键无效**：请确保游戏窗口在程序运行时处于激活状态
4. **播放速度不合适**：可以调整`main.py`中的`self.speed`值来改变播放速度

## 更新日志

### v1.0
- 初始版本
- 支持MIDI文件播放
- 支持自定义乐谱播放
- 实现基础的键盘映射和控制功能